{"ast":null,"code":"var _jsxFileName = \"/Users/jae/Downloads/dispatch_vehicles/dispatch_vehicles/simulation_vis/src/components/Trip.js\",\n  _s = $RefreshSig$();\n/* global window */\n// Trip.js - 여행 경로(Trip)의 지도상 시각화 및 슬라이더 기반 애니메이션 제어 컴포넌트\n\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport DeckGL from '@deck.gl/react';\nimport { Map } from 'react-map-gl';\nimport { AmbientLight, PointLight, LightingEffect } from '@deck.gl/core';\nimport { TripsLayer } from '@deck.gl/geo-layers';\nimport { ScatterplotLayer, ArcLayer } from '@deck.gl/layers';\nimport Slider from \"@mui/material/Slider\";\nimport \"../css/trip.css\";\n\n/* \r\n  Light 효과 정의: 지도 위 객체들이 더 입체적으로 보이도록 조명 효과를 지정 \r\n*/\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ambientLight = new AmbientLight({\n  color: [255, 255, 255],\n  // 환경광 색상\n  intensity: 1.0 // 밝기\n});\n\n// PointLight는 특정 위치에서 나오는 조명 효과\nconst pointLight = new PointLight({\n  color: [255, 255, 255],\n  intensity: 2.0,\n  position: [-74.05, 40.7, 8000] // 위도, 경도, 높이\n});\n\n// 위의 ambientLight와 pointLight를 합친 조명 효과\nconst lightingEffect = new LightingEffect({\n  ambientLight,\n  pointLight\n});\n\n/*\r\n  material: 3D 객체 표면의 반사/질감 효과 정보\r\n*/\nconst material = {\n  ambient: 0.1,\n  diffuse: 0.6,\n  shininess: 32,\n  specularColor: [60, 64, 70]\n};\nconst material2 = {\n  ambient: 0.3,\n  diffuse: 0.6,\n  shininess: 32,\n  specularCol: [60, 64, 70]\n};\n\n// theme 스타일 preset\nconst DEFAULT_THEME = {\n  buildingColor: [228, 228, 228],\n  buildingColor2: [255, 255, 255],\n  trailColor0: [253, 128, 93],\n  trailColor1: [23, 184, 190],\n  material,\n  material2,\n  effects: [lightingEffect]\n};\n\n// 초기 지도 뷰 설정 (위치, 확대, 시점 등)\nconst INITIAL_VIEW_STATE = {\n  longitude: 127.130622,\n  // 경도 (포항공대 위치 등, 실제 환경에 맞게 수정)\n  latitude: 37.451748,\n  // 위도\n  zoom: 15,\n  // 지도 확대 레벨\n  pitch: 30,\n  // 시점 각도\n  bearing: 0 // 지도의 회전 각도\n};\nconst minTime = 0;\nconst animationSpeed = 0.5;\nconst mapStyle = \"mapbox://styles/spear5306/ckzcz5m8w002814o2coz02sjc\";\n\n// mapbox API 키 (개인 키를 입력해서 사용)\nconst MAPBOX_TOKEN = `pk.eyJ1Ijoic2hlcnJ5MTAyNCIsImEiOiJjbG00dmtic3YwbGNoM2Zxb3V5NmhxZDZ6In0.ZBrAsHLwNihh7xqTify5hQ`;\n\n/* \r\n  애니메이션 시간 업데이트 함수: 한 틱(time step)씩 증가, 최대치 넘으면 다시 0으로 초기화\r\n*/\n// maxTime은 데이터에 따라 동적으로 계산 (컴포넌트 내부에서 계산)\n\n// 한 자리 숫자 시간(분/시) 앞에 0을 붙임 (시계 표기용)\nconst addZeroFill = value => {\n  const valueString = value.toString();\n  return valueString.length < 2 ? \"0\" + valueString : valueString;\n};\n\n/*\r\n  화면에 표시할 애니메이션 시간(시:분 포맷) 반환\r\n*/\nconst returnAnimationDisplayTime = time => {\n  const hour = addZeroFill(parseInt(Math.round(time) / 60 % 24));\n  const minute = addZeroFill(Math.round(time) % 60);\n  return [hour, minute];\n};\n\n/*\r\n  선택한 시각(time)에 유효한 trip만 골라내는 함수 (미사용)\r\n*/\nconst currData = (data, time) => {\n  const arr = [];\n  data.forEach(v => {\n    const timestamp = v.timestamp;\n    const s_t = timestamp[0];\n    const e_t = timestamp[timestamp.length - 1];\n    if (s_t <= time && e_t >= time) {\n      arr.push(v);\n    }\n  });\n  return arr;\n};\n\n/*\r\n  Trip 컴포넌트: 여행(trip) 경로 데이터를 받아, 지도 위에 시간에 따라 함선을 따라가는 듯한 애니메이션을 표시\r\n*/\nconst Trip = props => {\n  _s();\n  // time: 현재 트립 애니메이션의 시간(프레임)\n  const [time, setTime] = useState(minTime);\n  // animation: 애니메이션 frame id 저장용(해제시 사용)\n  const [animation] = useState({});\n  // trip 데이터 (경로, 시간 정보 포함)\n  const trip = props.trip;\n  const passengers = props.passengers || [];\n\n  // 데이터 기반 최대 시간 계산\n  const dataMaxFromTrips = React.useMemo(() => {\n    if (!trip || trip.length === 0) return 0;\n    let maxT = 0;\n    for (const t of trip) {\n      if (t && t.timestamp && t.timestamp.length) {\n        const last = t.timestamp[t.timestamp.length - 1];\n        if (typeof last === 'number' && last > maxT) maxT = last;\n      }\n    }\n    return maxT;\n  }, [trip]);\n  const dataMaxFromPassengers = React.useMemo(() => {\n    if (!passengers || passengers.length === 0) return 0;\n    let maxT = 0;\n    for (const p of passengers) {\n      if (p && p.timestamp && p.timestamp.length) {\n        const last = p.timestamp[p.timestamp.length - 1];\n        if (typeof last === 'number' && last > maxT) maxT = last;\n      }\n    }\n    return maxT;\n  }, [passengers]);\n  const maxTime = React.useMemo(() => {\n    const m = Math.max(60, dataMaxFromTrips, dataMaxFromPassengers);\n    return Number.isFinite(m) && m > 0 ? m : 60;\n  }, [dataMaxFromTrips, dataMaxFromPassengers]);\n\n  // 시간 증가 함수 (데이터 최대 시간 기준으로 순환)\n  const returnAnimationTime = useCallback(t => {\n    if (t > maxTime) {\n      return minTime;\n    }\n    return t + 0.01 * animationSpeed;\n  }, [maxTime]);\n\n  // 애니메이션 동작 함수: 시간이 0.01*speed 씩 증가하며, 애니메이션 갱신\n  const animate = useCallback(() => {\n    setTime(time => returnAnimationTime(time));\n    animation.id = window.requestAnimationFrame(animate);\n  }, [animation]);\n\n  // mount될 때 애니메이션 시작, unmount시 애니메이션 해제\n  useEffect(() => {\n    animation.id = window.requestAnimationFrame(animate);\n    return () => window.cancelAnimationFrame(animation.id);\n  }, [animation, animate]);\n\n  /**\r\n   * TripsLayer: 덱글에서 시간에 따라 경로(trip)의 움직임을 시각적으로 보여주는 레이어\r\n   * - id: 레이어 식별자\r\n   * - data: trip 객체 배열 (각 객체는 route(선 좌표 배열), timestamp(각 좌표의 시간), 등 필드 보유)\r\n   * - getPath: 각 trip 데이터에서 경로 추출 -> d.route는 위도/경도 좌표 배열\r\n   * - getTimestamps: 각 좌표별 시간 정보 배열 추출 -> d.timestamp\r\n   * - getColor: 트레일(이동 경로) 색상 지정 (예시: 노란색)\r\n   * - opacity: 불투명도\r\n   * - widthMinPixels: 선 폭(px 단위 최소값, 작은 값이면 너무 얇게 나와서 보기 어려움)\r\n   * - rounded, capRounded, jointRounded: 라인의 끝부분/꺾이는 부분을 둥글게 할지 여부\r\n   * - trailLength: 트레일 길이 (뒤에 잔상이 얼마만큼 남을지, 단위는 data timestamp 단위와 동일)\r\n   * - currentTime: 현재 애니메이션 시간 (이 값 이전까지의 경로만 표현됨)\r\n   * - shadowEnabled: 그림자 효과 적용 여부\r\n   */\n  // 현재 시간에 보일 승객만 필터링 (차량 도착 시점 이후에는 사라짐)\n  const visiblePassengers = React.useMemo(() => {\n    if (!passengers || passengers.length === 0) return [];\n    return passengers.filter(p => Array.isArray(p.timestamp) && p.timestamp.length === 2 && p.timestamp[0] <= time && p.timestamp[1] > time);\n  }, [passengers, time]);\n  const layers = [new TripsLayer({\n    id: 'trips',\n    data: trip,\n    getPath: d => d.route,\n    getTimestamps: d => d.timestamp,\n    getColor: [135, 206, 235],\n    opacity: 1,\n    widthMinPixels: 7,\n    rounded: true,\n    capRounded: true,\n    jointRounded: true,\n    trailLength: 0.5,\n    currentTime: time,\n    shadowEnabled: false\n  }),\n  // 승객: 흰색 포인트, 픽업 완료 시 사라짐\n  new ScatterplotLayer({\n    id: 'passengers',\n    data: visiblePassengers,\n    getPosition: d => d.location,\n    getFillColor: [255, 255, 255],\n    getRadius: 6,\n    radiusUnits: 'pixels',\n    pickable: true,\n    updateTriggers: {\n      getPosition: [time]\n    }\n  }),\n  // 목적지: 주황색 포인트, 픽업 이후부터 도착까지 표시\n  new ScatterplotLayer({\n    id: 'destinations',\n    data: (() => {\n      if (!trip || trip.length === 0) return [];\n      const arr = [];\n      for (const t of trip) {\n        if (!t || !t.route || !t.timestamp || t.route.length < 2 || t.timestamp.length < 2) continue;\n        const drop = t.route[t.route.length - 1];\n        const start = t.timestamp.length > 1 ? t.timestamp[1] : t.timestamp[0];\n        const end = t.timestamp[t.timestamp.length - 1];\n        if (typeof start !== 'number' || typeof end !== 'number') continue;\n        if (time >= start && time <= end) {\n          arr.push({\n            location: drop\n          });\n        }\n      }\n      return arr;\n    })(),\n    getPosition: d => d.location,\n    getFillColor: [255, 165, 0],\n    getRadius: 5,\n    radiusUnits: 'pixels',\n    pickable: false,\n    updateTriggers: {\n      getPosition: [time]\n    }\n  }),\n  // 매칭된 차량-승객 링크: ArcLayer(흰색), 현재 차량 위치 → 픽업 지점까지(픽업 완료 시 사라짐)\n  new ArcLayer({\n    id: 'match-arcs',\n    data: (() => {\n      if (!trip || trip.length === 0) return [];\n      const arcs = [];\n      for (const t of trip) {\n        if (!t || !t.route || !t.timestamp || t.route.length < 2 || t.timestamp.length < 2) continue;\n        const ts = t.timestamp;\n        const rt = t.route;\n        const start = ts[0];\n        const pickupTime = ts[1];\n        if (typeof start !== 'number' || typeof pickupTime !== 'number') continue;\n        if (time < start || time > pickupTime) continue;\n        // 현재 차량 위치 보간: ts[k] <= time < ts[k+1]\n        let idx = 0;\n        for (let k = 0; k < ts.length - 1; k++) {\n          if (typeof ts[k] === 'number' && typeof ts[k + 1] === 'number' && ts[k] <= time && time < ts[k + 1]) {\n            idx = k;\n            break;\n          }\n          if (time >= ts[ts.length - 1]) idx = ts.length - 2;\n        }\n        const a = rt[Math.max(0, Math.min(idx, rt.length - 1))];\n        const b = rt[Math.max(0, Math.min(idx + 1, rt.length - 1))];\n        const t0 = ts[Math.max(0, Math.min(idx, ts.length - 1))];\n        const t1 = ts[Math.max(0, Math.min(idx + 1, ts.length - 1))];\n        let curr = a;\n        if (typeof t0 === 'number' && typeof t1 === 'number' && t1 > t0) {\n          const alpha = Math.max(0, Math.min(1, (time - t0) / (t1 - t0)));\n          const x = a[0] + (b[0] - a[0]) * alpha;\n          const y = a[1] + (b[1] - a[1]) * alpha;\n          curr = [x, y];\n        }\n        const pickup = rt[1];\n        if (Array.isArray(curr) && Array.isArray(pickup)) {\n          arcs.push({\n            source: curr,\n            target: pickup\n          });\n        }\n      }\n      return arcs;\n    })(),\n    getSourcePosition: d => d.source,\n    getTargetPosition: d => d.target,\n    getSourceColor: [255, 255, 255],\n    getTargetColor: [255, 255, 255],\n    getWidth: 3,\n    pickable: false,\n    updateTriggers: {\n      getSourcePosition: [time],\n      getTargetPosition: [time]\n    }\n  }),\n  // 승객 탑승 중: 현재 차량 위치 → 목적지까지 주황색 얇은 아크\n  new ArcLayer({\n    id: 'occupied-arcs',\n    data: (() => {\n      if (!trip || trip.length === 0) return [];\n      const arcs = [];\n      for (const t of trip) {\n        if (!t || !t.route || !t.timestamp || t.route.length < 2 || t.timestamp.length < 2) continue;\n        const ts = t.timestamp;\n        const rt = t.route;\n        const pickupTime = ts[1];\n        const dropTime = ts[ts.length - 1];\n        if (typeof pickupTime !== 'number' || typeof dropTime !== 'number') continue;\n        if (time < pickupTime || time > dropTime) continue;\n\n        // 현재 위치 보간\n        let idx = 0;\n        for (let k = 0; k < ts.length - 1; k++) {\n          if (typeof ts[k] === 'number' && typeof ts[k + 1] === 'number' && ts[k] <= time && time < ts[k + 1]) {\n            idx = k;\n            break;\n          }\n          if (time >= ts[ts.length - 1]) idx = ts.length - 2;\n        }\n        const a = rt[Math.max(0, Math.min(idx, rt.length - 1))];\n        const b = rt[Math.max(0, Math.min(idx + 1, rt.length - 1))];\n        const t0 = ts[Math.max(0, Math.min(idx, ts.length - 1))];\n        const t1 = ts[Math.max(0, Math.min(idx + 1, ts.length - 1))];\n        let curr = a;\n        if (typeof t0 === 'number' && typeof t1 === 'number' && t1 > t0) {\n          const alpha = Math.max(0, Math.min(1, (time - t0) / (t1 - t0)));\n          const x = a[0] + (b[0] - a[0]) * alpha;\n          const y = a[1] + (b[1] - a[1]) * alpha;\n          curr = [x, y];\n        }\n        const dest = rt[rt.length - 1];\n        if (Array.isArray(curr) && Array.isArray(dest)) {\n          arcs.push({\n            source: curr,\n            target: dest\n          });\n        }\n      }\n      return arcs;\n    })(),\n    getSourcePosition: d => d.source,\n    getTargetPosition: d => d.target,\n    getSourceColor: [30, 144, 255],\n    getTargetColor: [30, 144, 255],\n    getWidth: 1.5,\n    pickable: false,\n    updateTriggers: {\n      getSourcePosition: [time],\n      getTargetPosition: [time]\n    }\n  })];\n\n  // 슬라이더로 시간 제어 시 호출되는 함수 (애니메이션 시간 수동 변경)\n  const SliderChange = value => {\n    const time = value.target.value;\n    setTime(time);\n  };\n\n  // 시:분 포맷(표시용) 얻기\n  const [hour, minute] = returnAnimationDisplayTime(time);\n\n  // 실제 렌더링\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"trip-container\",\n    style: {\n      position: \"relative\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(DeckGL, {\n      effects: DEFAULT_THEME.effects,\n      initialViewState: INITIAL_VIEW_STATE,\n      controller: true,\n      layers: layers,\n      children: /*#__PURE__*/_jsxDEV(Map, {\n        mapStyle: mapStyle,\n        mapboxAccessToken: MAPBOX_TOKEN,\n        preventStyleDiffing: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 373,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"time\",\n      children: [\"TIME : \", `${hour} : ${minute}`]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 383,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Slider, {\n      id: \"slider\",\n      value: time,\n      min: minTime,\n      max: maxTime,\n      onChange: SliderChange,\n      track: \"inverted\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 385,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 371,\n    columnNumber: 5\n  }, this);\n};\n_s(Trip, \"T4D6hYkHsCcxWzcM1nu0lBsql7w=\");\n_c = Trip;\nexport default Trip;\nvar _c;\n$RefreshReg$(_c, \"Trip\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","DeckGL","Map","AmbientLight","PointLight","LightingEffect","TripsLayer","ScatterplotLayer","ArcLayer","Slider","jsxDEV","_jsxDEV","ambientLight","color","intensity","pointLight","position","lightingEffect","material","ambient","diffuse","shininess","specularColor","material2","specularCol","DEFAULT_THEME","buildingColor","buildingColor2","trailColor0","trailColor1","effects","INITIAL_VIEW_STATE","longitude","latitude","zoom","pitch","bearing","minTime","animationSpeed","mapStyle","MAPBOX_TOKEN","addZeroFill","value","valueString","toString","length","returnAnimationDisplayTime","time","hour","parseInt","Math","round","minute","currData","data","arr","forEach","v","timestamp","s_t","e_t","push","Trip","props","_s","setTime","animation","trip","passengers","dataMaxFromTrips","useMemo","maxT","t","last","dataMaxFromPassengers","p","maxTime","m","max","Number","isFinite","returnAnimationTime","animate","id","window","requestAnimationFrame","cancelAnimationFrame","visiblePassengers","filter","Array","isArray","layers","getPath","d","route","getTimestamps","getColor","opacity","widthMinPixels","rounded","capRounded","jointRounded","trailLength","currentTime","shadowEnabled","getPosition","location","getFillColor","getRadius","radiusUnits","pickable","updateTriggers","drop","start","end","arcs","ts","rt","pickupTime","idx","k","a","min","b","t0","t1","curr","alpha","x","y","pickup","source","target","getSourcePosition","getTargetPosition","getSourceColor","getTargetColor","getWidth","dropTime","dest","SliderChange","className","style","children","initialViewState","controller","mapboxAccessToken","preventStyleDiffing","fileName","_jsxFileName","lineNumber","columnNumber","onChange","track","_c","$RefreshReg$"],"sources":["/Users/jae/Downloads/dispatch_vehicles/dispatch_vehicles/simulation_vis/src/components/Trip.js"],"sourcesContent":["/* global window */\r\n// Trip.js - 여행 경로(Trip)의 지도상 시각화 및 슬라이더 기반 애니메이션 제어 컴포넌트\r\n\r\nimport React, { useState, useEffect, useCallback } from \"react\";\r\n\r\nimport DeckGL from '@deck.gl/react';\r\nimport { Map } from 'react-map-gl';\r\n\r\nimport { AmbientLight, PointLight, LightingEffect } from '@deck.gl/core';\r\nimport { TripsLayer } from '@deck.gl/geo-layers';\r\nimport { ScatterplotLayer, ArcLayer } from '@deck.gl/layers';\r\n\r\nimport Slider from \"@mui/material/Slider\";\r\nimport \"../css/trip.css\";\r\n\r\n/* \r\n  Light 효과 정의: 지도 위 객체들이 더 입체적으로 보이도록 조명 효과를 지정 \r\n*/\r\nconst ambientLight = new AmbientLight({\r\n  color: [255, 255, 255],    // 환경광 색상\r\n  intensity: 1.0             // 밝기\r\n});\r\n\r\n// PointLight는 특정 위치에서 나오는 조명 효과\r\nconst pointLight = new PointLight({\r\n  color: [255, 255, 255],\r\n  intensity: 2.0,\r\n  position: [-74.05, 40.7, 8000] // 위도, 경도, 높이\r\n});\r\n\r\n// 위의 ambientLight와 pointLight를 합친 조명 효과\r\nconst lightingEffect = new LightingEffect({ ambientLight, pointLight });\r\n\r\n/*\r\n  material: 3D 객체 표면의 반사/질감 효과 정보\r\n*/\r\nconst material = {\r\n  ambient: 0.1,\r\n  diffuse: 0.6,\r\n  shininess: 32,\r\n  specularColor: [60, 64, 70]\r\n};\r\n\r\nconst material2 = {\r\n  ambient: 0.3,\r\n  diffuse: 0.6,\r\n  shininess: 32,\r\n  specularCol: [60, 64, 70]\r\n};\r\n\r\n// theme 스타일 preset\r\nconst DEFAULT_THEME = {\r\n  buildingColor: [228, 228, 228],\r\n  buildingColor2: [255, 255, 255],\r\n  trailColor0: [253, 128, 93],\r\n  trailColor1: [23, 184, 190],\r\n  material,\r\n  material2,\r\n  effects: [lightingEffect]\r\n};\r\n\r\n// 초기 지도 뷰 설정 (위치, 확대, 시점 등)\r\nconst INITIAL_VIEW_STATE = { \r\n  longitude: 127.130622, // 경도 (포항공대 위치 등, 실제 환경에 맞게 수정)\r\n  latitude: 37.451748,   // 위도\r\n  zoom: 15,              // 지도 확대 레벨\r\n  pitch: 30,             // 시점 각도\r\n  bearing: 0             // 지도의 회전 각도\r\n};\r\n\r\nconst minTime = 0;\r\nconst animationSpeed = 0.5;\r\nconst mapStyle = \"mapbox://styles/spear5306/ckzcz5m8w002814o2coz02sjc\";\r\n\r\n// mapbox API 키 (개인 키를 입력해서 사용)\r\nconst MAPBOX_TOKEN = `pk.eyJ1Ijoic2hlcnJ5MTAyNCIsImEiOiJjbG00dmtic3YwbGNoM2Zxb3V5NmhxZDZ6In0.ZBrAsHLwNihh7xqTify5hQ`;\r\n\r\n/* \r\n  애니메이션 시간 업데이트 함수: 한 틱(time step)씩 증가, 최대치 넘으면 다시 0으로 초기화\r\n*/\r\n// maxTime은 데이터에 따라 동적으로 계산 (컴포넌트 내부에서 계산)\r\n\r\n// 한 자리 숫자 시간(분/시) 앞에 0을 붙임 (시계 표기용)\r\nconst addZeroFill = (value) => {\r\n  const valueString = value.toString();\r\n  return valueString.length < 2 ? \"0\" + valueString : valueString;\r\n};\r\n\r\n/*\r\n  화면에 표시할 애니메이션 시간(시:분 포맷) 반환\r\n*/\r\nconst returnAnimationDisplayTime = (time) => {\r\n  const hour = addZeroFill(parseInt((Math.round(time) / 60) % 24));\r\n  const minute = addZeroFill(Math.round(time) % 60);\r\n  return [hour, minute];\r\n};\r\n\r\n/*\r\n  선택한 시각(time)에 유효한 trip만 골라내는 함수 (미사용)\r\n*/\r\nconst currData = (data, time) => {\r\n  const arr = [];\r\n  data.forEach((v) => {\r\n    const timestamp = v.timestamp;\r\n    const s_t = timestamp[0];\r\n    const e_t = timestamp[timestamp.length - 1];\r\n    if (s_t <= time && e_t >= time) {\r\n      arr.push(v);\r\n    }\r\n  });\r\n  return arr;\r\n};\r\n\r\n/*\r\n  Trip 컴포넌트: 여행(trip) 경로 데이터를 받아, 지도 위에 시간에 따라 함선을 따라가는 듯한 애니메이션을 표시\r\n*/\r\nconst Trip = (props) => {\r\n  // time: 현재 트립 애니메이션의 시간(프레임)\r\n  const [time, setTime] = useState(minTime);\r\n  // animation: 애니메이션 frame id 저장용(해제시 사용)\r\n  const [animation] = useState({});\r\n  // trip 데이터 (경로, 시간 정보 포함)\r\n  const trip = props.trip;\r\n  const passengers = props.passengers || [];\r\n\r\n  // 데이터 기반 최대 시간 계산\r\n  const dataMaxFromTrips = React.useMemo(() => {\r\n    if (!trip || trip.length === 0) return 0;\r\n    let maxT = 0;\r\n    for (const t of trip) {\r\n      if (t && t.timestamp && t.timestamp.length) {\r\n        const last = t.timestamp[t.timestamp.length - 1];\r\n        if (typeof last === 'number' && last > maxT) maxT = last;\r\n      }\r\n    }\r\n    return maxT;\r\n  }, [trip]);\r\n\r\n  const dataMaxFromPassengers = React.useMemo(() => {\r\n    if (!passengers || passengers.length === 0) return 0;\r\n    let maxT = 0;\r\n    for (const p of passengers) {\r\n      if (p && p.timestamp && p.timestamp.length) {\r\n        const last = p.timestamp[p.timestamp.length - 1];\r\n        if (typeof last === 'number' && last > maxT) maxT = last;\r\n      }\r\n    }\r\n    return maxT;\r\n  }, [passengers]);\r\n\r\n  const maxTime = React.useMemo(() => {\r\n    const m = Math.max(60, dataMaxFromTrips, dataMaxFromPassengers);\r\n    return Number.isFinite(m) && m > 0 ? m : 60;\r\n  }, [dataMaxFromTrips, dataMaxFromPassengers]);\r\n\r\n  // 시간 증가 함수 (데이터 최대 시간 기준으로 순환)\r\n  const returnAnimationTime = useCallback((t) => {\r\n    if (t > maxTime) {\r\n      return minTime;\r\n    }\r\n    return t + 0.01 * animationSpeed;\r\n  }, [maxTime]);\r\n\r\n  // 애니메이션 동작 함수: 시간이 0.01*speed 씩 증가하며, 애니메이션 갱신\r\n  const animate = useCallback(() => {\r\n    setTime((time) => returnAnimationTime(time));\r\n    animation.id = window.requestAnimationFrame(animate);\r\n  }, [animation]);\r\n\r\n  // mount될 때 애니메이션 시작, unmount시 애니메이션 해제\r\n  useEffect(() => {\r\n    animation.id = window.requestAnimationFrame(animate);\r\n    return () => window.cancelAnimationFrame(animation.id);\r\n  }, [animation, animate]);\r\n\r\n  /**\r\n   * TripsLayer: 덱글에서 시간에 따라 경로(trip)의 움직임을 시각적으로 보여주는 레이어\r\n   * - id: 레이어 식별자\r\n   * - data: trip 객체 배열 (각 객체는 route(선 좌표 배열), timestamp(각 좌표의 시간), 등 필드 보유)\r\n   * - getPath: 각 trip 데이터에서 경로 추출 -> d.route는 위도/경도 좌표 배열\r\n   * - getTimestamps: 각 좌표별 시간 정보 배열 추출 -> d.timestamp\r\n   * - getColor: 트레일(이동 경로) 색상 지정 (예시: 노란색)\r\n   * - opacity: 불투명도\r\n   * - widthMinPixels: 선 폭(px 단위 최소값, 작은 값이면 너무 얇게 나와서 보기 어려움)\r\n   * - rounded, capRounded, jointRounded: 라인의 끝부분/꺾이는 부분을 둥글게 할지 여부\r\n   * - trailLength: 트레일 길이 (뒤에 잔상이 얼마만큼 남을지, 단위는 data timestamp 단위와 동일)\r\n   * - currentTime: 현재 애니메이션 시간 (이 값 이전까지의 경로만 표현됨)\r\n   * - shadowEnabled: 그림자 효과 적용 여부\r\n   */\r\n  // 현재 시간에 보일 승객만 필터링 (차량 도착 시점 이후에는 사라짐)\r\n  const visiblePassengers = React.useMemo(() => {\r\n    if (!passengers || passengers.length === 0) return [];\r\n    return passengers.filter((p) => Array.isArray(p.timestamp) && p.timestamp.length === 2 && p.timestamp[0] <= time && p.timestamp[1] > time);\r\n  }, [passengers, time]);\r\n\r\n  const layers = [\r\n    new TripsLayer({  \r\n      id: 'trips',\r\n      data: trip,\r\n      getPath: d => d.route,\r\n      getTimestamps: d => d.timestamp,\r\n      getColor: [135,206, 235],\r\n      opacity: 1,\r\n      widthMinPixels: 7,\r\n      rounded: true,\r\n      capRounded : true,\r\n      jointRounded : true,\r\n      trailLength : 0.5,\r\n      currentTime: time,\r\n      shadowEnabled: false\r\n    }),\r\n    // 승객: 흰색 포인트, 픽업 완료 시 사라짐\r\n    new ScatterplotLayer({\r\n      id: 'passengers',\r\n      data: visiblePassengers,\r\n      getPosition: d => d.location,\r\n      getFillColor: [255, 255, 255],\r\n      getRadius: 6,\r\n      radiusUnits: 'pixels',\r\n      pickable: true,\r\n      updateTriggers: {\r\n        getPosition: [time]\r\n      }\r\n    }),\r\n    // 목적지: 주황색 포인트, 픽업 이후부터 도착까지 표시\r\n    new ScatterplotLayer({\r\n      id: 'destinations',\r\n      data: (() => {\r\n        if (!trip || trip.length === 0) return [];\r\n        const arr = [];\r\n        for (const t of trip) {\r\n          if (!t || !t.route || !t.timestamp || t.route.length < 2 || t.timestamp.length < 2) continue;\r\n          const drop = t.route[t.route.length - 1];\r\n          const start = t.timestamp.length > 1 ? t.timestamp[1] : t.timestamp[0];\r\n          const end = t.timestamp[t.timestamp.length - 1];\r\n          if (typeof start !== 'number' || typeof end !== 'number') continue;\r\n          if (time >= start && time <= end) {\r\n            arr.push({ location: drop });\r\n          }\r\n        }\r\n        return arr;\r\n      })(),\r\n      getPosition: d => d.location,\r\n      getFillColor: [255, 165, 0],\r\n      getRadius: 5,\r\n      radiusUnits: 'pixels',\r\n      pickable: false,\r\n      updateTriggers: {\r\n        getPosition: [time]\r\n      }\r\n    }),\r\n    // 매칭된 차량-승객 링크: ArcLayer(흰색), 현재 차량 위치 → 픽업 지점까지(픽업 완료 시 사라짐)\r\n    new ArcLayer({\r\n      id: 'match-arcs',\r\n      data: (() => {\r\n        if (!trip || trip.length === 0) return [];\r\n        const arcs = [];\r\n        for (const t of trip) {\r\n          if (!t || !t.route || !t.timestamp || t.route.length < 2 || t.timestamp.length < 2) continue;\r\n          const ts = t.timestamp;\r\n          const rt = t.route;\r\n          const start = ts[0];\r\n          const pickupTime = ts[1];\r\n          if (typeof start !== 'number' || typeof pickupTime !== 'number') continue;\r\n          if (time < start || time > pickupTime) continue;\r\n          // 현재 차량 위치 보간: ts[k] <= time < ts[k+1]\r\n          let idx = 0;\r\n          for (let k = 0; k < ts.length - 1; k++) {\r\n            if (typeof ts[k] === 'number' && typeof ts[k+1] === 'number' && ts[k] <= time && time < ts[k+1]) {\r\n              idx = k;\r\n              break;\r\n            }\r\n            if (time >= ts[ts.length - 1]) idx = ts.length - 2;\r\n          }\r\n          const a = rt[Math.max(0, Math.min(idx, rt.length - 1))];\r\n          const b = rt[Math.max(0, Math.min(idx + 1, rt.length - 1))];\r\n          const t0 = ts[Math.max(0, Math.min(idx, ts.length - 1))];\r\n          const t1 = ts[Math.max(0, Math.min(idx + 1, ts.length - 1))];\r\n          let curr = a;\r\n          if (typeof t0 === 'number' && typeof t1 === 'number' && t1 > t0) {\r\n            const alpha = Math.max(0, Math.min(1, (time - t0) / (t1 - t0)));\r\n            const x = a[0] + (b[0] - a[0]) * alpha;\r\n            const y = a[1] + (b[1] - a[1]) * alpha;\r\n            curr = [x, y];\r\n          }\r\n          const pickup = rt[1];\r\n          if (Array.isArray(curr) && Array.isArray(pickup)) {\r\n            arcs.push({ source: curr, target: pickup });\r\n          }\r\n        }\r\n        return arcs;\r\n      })(),\r\n      getSourcePosition: d => d.source,\r\n      getTargetPosition: d => d.target,\r\n      getSourceColor: [255, 255, 255],\r\n      getTargetColor: [255, 255, 255],\r\n      getWidth: 3,\r\n      pickable: false,\r\n      updateTriggers: {\r\n        getSourcePosition: [time],\r\n        getTargetPosition: [time]\r\n      }\r\n    }),\r\n    // 승객 탑승 중: 현재 차량 위치 → 목적지까지 주황색 얇은 아크\r\n    new ArcLayer({\r\n      id: 'occupied-arcs',\r\n      data: (() => {\r\n        if (!trip || trip.length === 0) return [];\r\n        const arcs = [];\r\n        for (const t of trip) {\r\n          if (!t || !t.route || !t.timestamp || t.route.length < 2 || t.timestamp.length < 2) continue;\r\n          const ts = t.timestamp;\r\n          const rt = t.route;\r\n          const pickupTime = ts[1];\r\n          const dropTime = ts[ts.length - 1];\r\n          if (typeof pickupTime !== 'number' || typeof dropTime !== 'number') continue;\r\n          if (time < pickupTime || time > dropTime) continue;\r\n\r\n          // 현재 위치 보간\r\n          let idx = 0;\r\n          for (let k = 0; k < ts.length - 1; k++) {\r\n            if (typeof ts[k] === 'number' && typeof ts[k+1] === 'number' && ts[k] <= time && time < ts[k+1]) {\r\n              idx = k;\r\n              break;\r\n            }\r\n            if (time >= ts[ts.length - 1]) idx = ts.length - 2;\r\n          }\r\n          const a = rt[Math.max(0, Math.min(idx, rt.length - 1))];\r\n          const b = rt[Math.max(0, Math.min(idx + 1, rt.length - 1))];\r\n          const t0 = ts[Math.max(0, Math.min(idx, ts.length - 1))];\r\n          const t1 = ts[Math.max(0, Math.min(idx + 1, ts.length - 1))];\r\n          let curr = a;\r\n          if (typeof t0 === 'number' && typeof t1 === 'number' && t1 > t0) {\r\n            const alpha = Math.max(0, Math.min(1, (time - t0) / (t1 - t0)));\r\n            const x = a[0] + (b[0] - a[0]) * alpha;\r\n            const y = a[1] + (b[1] - a[1]) * alpha;\r\n            curr = [x, y];\r\n          }\r\n\r\n          const dest = rt[rt.length - 1];\r\n          if (Array.isArray(curr) && Array.isArray(dest)) {\r\n            arcs.push({ source: curr, target: dest });\r\n          }\r\n        }\r\n        return arcs;\r\n      })(),\r\n      getSourcePosition: d => d.source,\r\n      getTargetPosition: d => d.target,\r\n      getSourceColor: [30, 144, 255],\r\n      getTargetColor: [30, 144, 255],\r\n      getWidth: 1.5,\r\n      pickable: false,\r\n      updateTriggers: {\r\n        getSourcePosition: [time],\r\n        getTargetPosition: [time]\r\n      }\r\n    })\r\n  ];\r\n  \r\n  // 슬라이더로 시간 제어 시 호출되는 함수 (애니메이션 시간 수동 변경)\r\n  const SliderChange = (value) => {\r\n    const time = value.target.value;\r\n    setTime(time);\r\n  };\r\n\r\n  // 시:분 포맷(표시용) 얻기\r\n  const [hour, minute] = returnAnimationDisplayTime(time);\r\n\r\n  // 실제 렌더링\r\n  return (\r\n    <div className=\"trip-container\" style={{ position: \"relative\" }}>\r\n      {/* DeckGL: 지도와, trips 경로를 레이어로 올려 시각화 */}\r\n      <DeckGL\r\n        effects={DEFAULT_THEME.effects}\r\n        initialViewState={INITIAL_VIEW_STATE}\r\n        controller={true}\r\n        layers={layers}\r\n      >\r\n        {/*.react-map-gl의 Map: 실제 지도의 스타일 및 Mapbox 토큰 적용 */}\r\n        <Map mapStyle={mapStyle} mapboxAccessToken={MAPBOX_TOKEN} preventStyleDiffing={true}/>\r\n      </DeckGL>\r\n      {/* 현재 시간 표시 */}\r\n      <h1 className=\"time\">TIME : {`${hour} : ${minute}`}</h1>\r\n      {/* 시간 슬라이더: 사용자 조작으로 원하는 시간에 맞춰 볼 수 있음 */}\r\n      <Slider\r\n        id=\"slider\"\r\n        value={time}\r\n        min={minTime}\r\n        max={maxTime}\r\n        onChange={SliderChange}\r\n        track=\"inverted\"\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Trip;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}